<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Predict Gene Expression — predict_query • rsynthbio</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Predict Gene Expression — predict_query"><meta name="description" content="Sends a query to the Synthesize Bio API for prediction
and retrieves gene expression samples. This function validates the query, sends it
to the API, and processes the response into usable data frames."><meta property="og:description" content="Sends a query to the Synthesize Bio API for prediction
and retrieves gene expression samples. This function validates the query, sends it
to the API, and processes the response into usable data frames."><meta property="og:image" content="https://synthesizebio.github.io/rsynthbio/logo.png"><link rel="icon" type="image/png" href="https://github.com/synthesizebio/rsynthbio/tree/main/assets/logomark.png?raw=true"><link rel="shortcut icon" type="image/png" href="https://github.com/synthesizebio/rsynthbio/tree/main/assets/logomark.png?raw=true"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">
    <img src="https://github.com/synthesizebio/rsynthbio/blob/main/assets/whitelogo.png?raw=true" width="200px"><a class="navbar-brand me-2" href="../index.html">rsynthbio</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/getting-started.html">Getting Started</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/synthesizebio/rsynthbio" aria-label="GitHub repository"><span class="fa fa-github"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://www.synthesize.bio/">Synthesize.bio main page</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Predict Gene Expression</h1>
      <small class="dont-index">Source: <a href="https://github.com/synthesizebio/rsynthbio/blob/main/R/call_model_api.R" class="external-link"><code>R/call_model_api.R</code></a></small>
      <div class="d-none name"><code>predict_query.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Sends a query to the Synthesize Bio API for prediction
and retrieves gene expression samples. This function validates the query, sends it
to the API, and processes the response into usable data frames.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">predict_query</span><span class="op">(</span></span>
<span>  <span class="va">query</span>,</span>
<span>  as_counts <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  api_base_url <span class="op">=</span> <span class="va">API_BASE_URL</span>,</span>
<span>  poll_interval_seconds <span class="op">=</span> <span class="va">DEFAULT_POLL_INTERVAL_SECONDS</span>,</span>
<span>  poll_timeout_seconds <span class="op">=</span> <span class="va">DEFAULT_POLL_TIMEOUT_SECONDS</span>,</span>
<span>  return_download_url <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-query">query<a class="anchor" aria-label="anchor" href="#arg-query"></a></dt>
<dd><p>A list representing the query data to send to the API.
Use `get_valid_query()` to generate an example. The query supports additional
optional fields:</p><ul><li><p>`total_count` (integer): Library size used when converting predicted log CPM
        back to raw counts. Higher values scale counts up proportionally.</p></li>
<li><p>`deterministic_latents` (logical): If TRUE, the model uses the mean of each
        latent distribution instead of sampling, producing deterministic outputs for
        the same inputs. Useful for reproducibility.</p></li>
<li><p>`seed` (integer): Random seed for reproducibility.</p></li>
</ul></dd>


<dt id="arg-as-counts">as_counts<a class="anchor" aria-label="anchor" href="#arg-as-counts"></a></dt>
<dd><p>Logical, if FALSE, transforms the predicted expression counts
into logCPM (default is TRUE, returning raw counts).</p></dd>


<dt id="arg-api-base-url">api_base_url<a class="anchor" aria-label="anchor" href="#arg-api-base-url"></a></dt>
<dd><p>The base URL for the API server. Default is API_BASE_URL.</p></dd>


<dt id="arg-poll-interval-seconds">poll_interval_seconds<a class="anchor" aria-label="anchor" href="#arg-poll-interval-seconds"></a></dt>
<dd><p>Seconds between polling attempts of the status endpoint.
Default is DEFAULT_POLL_INTERVAL_SECONDS (2).</p></dd>


<dt id="arg-poll-timeout-seconds">poll_timeout_seconds<a class="anchor" aria-label="anchor" href="#arg-poll-timeout-seconds"></a></dt>
<dd><p>Maximum total seconds to wait before timing out.
Default is DEFAULT_POLL_TIMEOUT_SECONDS (900 = 15 minutes).</p></dd>


<dt id="arg-return-download-url">return_download_url<a class="anchor" aria-label="anchor" href="#arg-return-download-url"></a></dt>
<dd><p>Logical, if TRUE, returns a list containing the signed
download URL instead of parsing into data frames. Default is FALSE.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list. If `return_download_url` is `FALSE` (default), the list contains
        two data frames: `metadata` and `expression`. If `TRUE`, the list
        contains `download_url` and empty `metadata` and `expression` data frames.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Set your API key (in practice, use a more secure method)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># To start using rsynthbio, first you need to have an account with synthesize.bio.</span></span></span>
<span class="r-in"><span><span class="co"># Go here to create one: https://app.synthesize.bio/</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="set_synthesize_token.html">set_synthesize_token</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create a query</span></span></span>
<span class="r-in"><span><span class="va">query</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_valid_query.html">get_valid_query</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Request raw counts</span></span></span>
<span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">predict_query</span><span class="op">(</span><span class="va">query</span>, as_counts <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Access the results</span></span></span>
<span class="r-in"><span><span class="va">metadata</span> <span class="op">&lt;-</span> <span class="va">result</span><span class="op">$</span><span class="va">metadata</span></span></span>
<span class="r-in"><span><span class="va">expression</span> <span class="op">&lt;-</span> <span class="va">result</span><span class="op">$</span><span class="va">expression</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Request log CPM transformed data</span></span></span>
<span class="r-in"><span><span class="va">log_result</span> <span class="op">&lt;-</span> <span class="fu">predict_query</span><span class="op">(</span><span class="va">query</span>, as_counts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">log_expression</span> <span class="op">&lt;-</span> <span class="va">log_result</span><span class="op">$</span><span class="va">expression</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Explore the top expressed genes in the first sample</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">expression</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use deterministic latents for reproducible results</span></span></span>
<span class="r-in"><span><span class="va">query</span><span class="op">$</span><span class="va">deterministic_latents</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="va">result_det</span> <span class="op">&lt;-</span> <span class="fu">predict_query</span><span class="op">(</span><span class="va">query</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Specify a custom total count (library size)</span></span></span>
<span class="r-in"><span><span class="va">query</span><span class="op">$</span><span class="va">total_count</span> <span class="op">&lt;-</span> <span class="fl">5000000</span></span></span>
<span class="r-in"><span><span class="va">result_custom</span> <span class="op">&lt;-</span> <span class="fu">predict_query</span><span class="op">(</span><span class="va">query</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Candace Savonen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

